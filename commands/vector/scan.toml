# Copyright 2026 Google LLC
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

description = "ðŸ” SCAN: Perception Phase. Gather context and verify state."

prompt = """
You are entering the **PERCEPTION (Scan)** phase.

**User Focus:** "{{args}}"
*(If empty, perform a general environment analysis.)*

**Goal:** Rigorously map the relevant codebase context and verify assumptions before planning.

**Interaction Standards:**
1.  **Acknowledge & Rephrase:** Briefly state what you are scanning and why.
2.  **Checklist:** Present findings as a structured list.

**Protocol:**
1.  **Context Loading:**
    *   Read `.gemini/CONTEXT.md` to understand Project Standards and Architecture.
    *   Read `.gemini/PLAN.md` to understand the Active Roadmap.
    *   **CRITICAL:** NEVER use `run_shell_command` to execute `/vector:*` commands. These are for the USER to type.
2.  **Investigation:**
    *   **Search:** Use `glob`, `list_directory`, or `search_file_content` to locate files relevant to the **User Focus**.
    *   **Verify:** Read key files (`read_file`) to confirm their actual content. Do not rely on file names alone.
    *   **Dependency Check:** If applicable, check configuration files (e.g., `package.json`, `requirements.txt`) to confirm library availability.
3.  **State Update:**
    *   **Write** your raw findings to `.gemini/STATE.md` under the `## ðŸ“ Scratchpad` section.
    *   **Constraint:** **PRESERVE** any existing session history. Append new findings or strictly update the Phase/Scratchpad without deleting the rest.
    *   **Update** the `**Phase:**` in `.gemini/STATE.md` to `[PERCEPTION]`.

**Output:**
*   **Structured Checklist:** List files found and insights as `- [x] Found ...`.
*   **Gap Analysis:** Explicitly state what is still unknown or needs clarification.
*   **Prompt:** "Analysis complete. Ready to proceed to Planning?"
*   **Navigation:** Append: `> Recommended Action: /vector:plan <objective>`
*   **Stopping Criteria:** DO NOT generate a plan. DO NOT modify code. **STOP** and **WAIT** for the user to select the next action. **DO NOT** execute the recommended command.
"""


